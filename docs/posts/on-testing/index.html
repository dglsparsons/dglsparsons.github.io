<!DOCTYPE html><html domain=dgls.dev ga-id=UA-177820617-1 lang=en><meta charset=utf-8><meta content="width=device-width,initial-scale=1" name=viewport><link href="/img/favicon/favicon.ico?hash=ba55cd0070" rel=icon><meta content=#f9c412 name=theme-color><title>You should only write USEFUL tests</title><meta content="dgls | dev" property=og:site_name><meta content=https://dgls.dev property=og:url><meta content="You should only write USEFUL tests" property=og:title><meta content=website property=og:type><meta content="You should only write USEFUL tests" property=twitter:title><meta content="A common mistake is to test every piece of code you write. This can be harmful and unnecessary. Let's explore why." name=description><meta content="A common mistake is to test every piece of code you write. This can be harmful and unnecessary. Let's explore why." property=og:description><meta content="A common mistake is to test every piece of code you write. This can be harmful and unnecessary. Let's explore why." property=twitter:description><meta content=summary_large_image name=twitter:card><meta content=@dglsparsons name=twitter:site><meta content=@dglsparsons name=twitter:creator><meta content=https://dgls.dev/img/remote/immobile-1280w.jpg property=twitter:image><meta content=https://dgls.dev/img/remote/immobile-1280w.jpg property=og:image><link href=https://dgls.dev/posts/on-testing/ rel=canonical><meta content=no-referrer-when-downgrade name=referrer><link href=/feed/feed.xml rel=alternate title="dgls | blog" type=application/atom+xml><link href=/ rel=preconnect crossorigin=""><script src="/js/min.js?hash=17b5d2d281" async defer></script><script src="/js/cached.js?hash=4628d5e26f" async defer></script><script csp-hash="">if (/Mac OS X/.test(navigator.userAgent))document.documentElement.classList.add('apple')</script><style>:root{--primary: #5DFDCB;--primary-dark: #02DE99}.hero,body{display:flex;flex-direction:column}body{min-height:100vh}body main{flex-grow:1}dialog,share-widget{position:fixed;opacity:.9}share-widget{right:20px;bottom:20px}share-widget div{width:30px;height:30px;background-image:url(/img/share.svg);background-repeat:no-repeat;background-position:center}.apple share-widget div{background-image:url(/img/share-apple.svg)}body,share-widget button{margin:0}share-widget button:active{transform:scale(1.2)}dialog{background-color:var(--primary-dark)}aside,form small{font-style:italic}#nav{z-index:2;position:relative}#reading-progress{z-index:1;background-color:var(--primary);width:100vw;position:absolute;left:0;top:0;bottom:0;transform:translate(-100vw,0);will-change:transform;pointer-events:none}@font-face{font-display:swap;font-family:'Inter UI';font-style:normal;font-weight:100;src:url(/fonts/Inter-Thin.woff2) format("woff2"),url(/fonts/Inter-Thin.woff) format("woff")}@font-face{font-display:swap;font-family:'Inter UI';font-style:italic;font-weight:100;src:url(/fonts/Inter-ThinItalic.woff2) format("woff2"),url(/fonts/Inter-ThinItalic.woff) format("woff")}@font-face{font-display:swap;font-family:'Inter UI';font-style:normal;font-weight:200;src:url(/fonts/Inter-ExtraLight.woff2) format("woff2"),url(/fonts/Inter-ExtraLight.woff) format("woff")}@font-face{font-display:swap;font-family:'Inter UI';font-style:italic;font-weight:200;src:url(/fonts/Inter-ExtraLightItalic.woff2) format("woff2"),url(/fonts/Inter-ExtraLightItalic.woff) format("woff")}@font-face{font-display:swap;font-family:'Inter UI';font-style:normal;font-weight:300;src:url(/fonts/Inter-Light.woff2) format("woff2"),url(/fonts/Inter-Light.woff) format("woff")}@font-face{font-display:swap;font-family:'Inter UI';font-style:italic;font-weight:300;src:url(/fonts/Inter-LightItalic.woff2) format("woff2"),url(/fonts/Inter-LightItalic.woff) format("woff")}@font-face{font-display:swap;font-family:'Inter UI';font-style:normal;font-weight:400;src:url(/fonts/Inter-Regular.woff2) format("woff2"),url(/fonts/Inter-Regular.woff) format("woff")}@font-face{font-display:swap;font-family:'Inter UI';font-style:italic;font-weight:400;src:url(/fonts/Inter-Italic.woff2) format("woff2"),url(/fonts/Inter-Italic.woff) format("woff")}@font-face{font-display:swap;font-family:'Inter UI';font-style:normal;font-weight:500;src:url(/fonts/Inter-Medium.woff2) format("woff2"),url(/fonts/Inter-Medium.woff) format("woff")}@font-face{font-display:swap;font-family:'Inter UI';font-style:italic;font-weight:500;src:url(/fonts/Inter-MediumItalic.woff2) format("woff2"),url(/fonts/Inter-MediumItalic.woff) format("woff")}@font-face{font-display:swap;font-family:'Inter UI';font-style:normal;font-weight:600;src:url(/fonts/Inter-SemiBold.woff2) format("woff2"),url(/fonts/Inter-SemiBold.woff) format("woff")}@font-face{font-display:swap;font-family:'Inter UI';font-style:italic;font-weight:600;src:url(/fonts/Inter-SemiBoldItalic.woff2) format("woff2"),url(/fonts/Inter-SemiBoldItalic.woff) format("woff")}@font-face{font-display:swap;font-family:'Inter UI';font-style:normal;font-weight:700;src:url(/fonts/Inter-Bold.woff2) format("woff2"),url(/fonts/Inter-Bold.woff) format("woff")}@font-face{font-display:swap;font-family:'Inter UI';font-style:italic;font-weight:700;src:url(/fonts/Inter-BoldItalic.woff2) format("woff2"),url(/fonts/Inter-BoldItalic.woff) format("woff")}@font-face{font-display:swap;font-family:'Inter UI';font-style:normal;font-weight:800;src:url(/fonts/Inter-ExtraBold.woff2) format("woff2"),url(/fonts/Inter-ExtraBold.woff) format("woff")}@font-face{font-display:swap;font-family:'Inter UI';font-style:italic;font-weight:800;src:url(/fonts/Inter-ExtraBoldItalic.woff2) format("woff2"),url(/fonts/Inter-ExtraBoldItalic.woff) format("woff")}@font-face{font-display:swap;font-family:'Inter UI';font-style:normal;font-weight:900;src:url(/fonts/Inter-Black.woff2) format("woff2"),url(/fonts/Inter-Black.woff) format("woff")}@font-face{font-display:swap;font-family:'Inter UI';font-style:italic;font-weight:900;src:url(/fonts/Inter-BlackItalic.woff2) format("woff2"),url(/fonts/Inter-BlackItalic.woff) format("woff")}@font-face{font-display:swap;font-family:'Inter UI var alt';font-weight:100 900;font-style:normal;font-named-instance:'Regular';src:url(/fonts/Inter-roman.var.woff2) format("woff2")}@font-face{font-display:swap;font-family:'Inter UI var alt';font-weight:100 900;font-style:italic;font-named-instance:'Italic';src:url(/fonts/Inter-italic.var.woff2) format("woff2")}.hero{min-height:600px;width:100%;background-position:top;background-size:cover;align-items:center;justify-content:center}html{scroll-padding-top:4rem;-webkit-text-size-adjust:100%}h1{line-height:3rem;font-size:3rem;margin:.67em 0}pre{max-width:calc(100%-3rem)}a{background-color:transparent;text-decoration:none;color:#444}b{font-weight:700}button,code{font-size:1rem}small{font-size:80%;color:#ccc}img{display:block;border-style:none;max-width:100%;height:auto;margin:0 auto}button,html{line-height:1.15}button{font-family:inherit;overflow:visible;text-transform:none}[type=button],button{-webkit-appearance:button}[type=button]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}progress{vertical-align:baseline}h2{line-height:1.2;margin-bottom:.6em;line-height:2.4rem;margin-bottom:1.36rem;font-size:1.728rem}body,p,pre{font-size:1rem;line-height:1.6}p,pre{margin-bottom:1.5em}code,pre{overflow-x:auto}pre{font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace}pre code:not([class]){padding:1.5em;overflow-x:scroll}button,code{border-radius:.3em}code{color:#e2777a;padding:0 .3em;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;font-size:90%;background:#2d2d2d}h1,h2,html{font-family:Inter UI,sans-serif}a:hover,p a{text-decoration:underline}@media (min-width:600px){h1{font-size:4.3978rem;line-height:4.4rem;margin-bottom:1.496rem}body,p,pre{font-size:1.1rem;line-height:1.6}h2,p,pre{margin-bottom:1.496rem}}@media (min-width:1200px){body,p,pre{font-size:1.2rem;line-height:1.6}p,pre{margin-bottom:1.632rem}}@media (max-width:767px){x:-moz-any-link{display:table-cell}}@supports (font-variation-settings:normal){html{font-family:Inter UI var alt,sans-serif}}form{padding:1.5em 1.5em 0;border:.2rem solid #202020;margin-bottom:1.5em}button{max-width:100%;background:#f2f2f2;color:#191919;cursor:pointer;display:inline-block;padding:.75em 1.5em;text-align:center;margin:0 .75em 1.5em 0}form>:not(fieldset){margin-right:.75em}button:hover{background:#d9d9d9;color:#000}button:not([disabled]){background:#f9c412;color:#fff;background:var(--primary)}button:not([disabled]):hover{background:#ba9005;color:#000;background:var(--primary-dark)}*{border:0;box-sizing:border-box}body,header nav a{font-family:Inter UI,sans-serif;color:#444}body,header nav{background:#fff}section{margin-left:auto;margin-right:auto;width:900px}header{text-align:center;max-width:100%;display:flex;align-items:center;flex-direction:column}header p{margin-top:0}header nav{position:fixed;top:0;left:0;width:100vw;padding:1rem;font-weight:200;text-align:right}header nav h1{float:left;font-size:inherit;line-height:inherit;margin:0;text-align:left}header nav a{font-weight:700;text-decoration:none;margin-left:1.5em}header nav a:first-of-type{margin-left:auto}header nav a:last-of-type{margin-right:1.5em}footer{background:#e9e9e9;padding:2rem;text-align:center}footer>*{margin:1.5em}footer nav a img{vertical-align:middle}footer nav,footer p{font-size:90%}article{max-width:50rem;padding:1rem;margin:0 auto}blockquote{border-left:1px solid #f9c412;padding:0 1.5em;margin:1.5em 0 1.5em 1.5em}blockquote footer{background:0 0;display:block;color:#ccc;padding:.75em 0;font-size:90%;text-align:start}code[class*=language-],pre[class*=language-]{color:#ccc;background:0 0;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none}pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto}:not(pre)>code[class*=language-],pre[class*=language-]{background:#2d2d2d}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal}.token.punctuation{color:#ccc}.token.function{color:#f08d49}.token.property{color:#f8c555}.token.builtin,.token.important,.token.keyword{color:#cc99cd}.token.operator,.token.url{color:#67cdcc}.token.important{font-weight:700}.token.inserted{color:green}</style><header><nav><div id=nav><h1><a href=/ title=Homepage>dgls | blog</a></h1><a href=/about/ >About</a></div><div id=reading-progress aria-hidden=true></div></nav><div class=hero style="background-image: linear-gradient(rgba(255, 255, 255, 0.8), rgba(255, 255, 255, 0.8)), url('/img/remote/immobile-1280w.jpg')"><h1>You should only write USEFUL tests</h1><time datetime=2020-09-18>18 Sep 2020</time><aside>7 min read.</aside></div><dialog id=message></dialog></header><main><article><p>Through my career in software I've come across a broad range of attitudes and opinions towards testing code. The two extremes being that 'tests aren't worth writing because something is too complicated', or that 'every single piece of code being checked in should be accompanied by tests'. Of these two contrasting opinions the latter, although not always in such an extreme form, is much more prevalent. Here, I will argue three cases why we don't always need to test code: the obvious correctness isolated pieces of code can have; the redundancy badly coupled tests can experience when refactoring; and the often immutability of business-critical code. Instead, I believe that we should be carefully considering where tests truly are required before implementing any.<p><picture><source sizes="(max-width: 608px) 100vw, 608px" srcset="/img/remote/nID5p-1920w.webp 1920w, /img/remote/nID5p-1280w.webp 1280w, /img/remote/nID5p-640w.webp 640w, /img/remote/nID5p-320w.webp 320w" type=image/webp><source sizes="(max-width: 608px) 100vw, 608px" srcset="/img/remote/nID5p-1920w.jpg 1920w, /img/remote/nID5p-1280w.jpg 1280w, /img/remote/nID5p-640w.jpg 640w, /img/remote/nID5p-320w.jpg 320w" type=image/jpeg><img alt="Your tests are bad and you should feel bad" decoding=async height=360 loading=lazy src=/img/remote/nID5p.jpeg style="background-size:cover;contain-intrinsic-size: min(var(--main-width), 480px) min(calc(var(--main-width) * 0.75), 360px);background-image:url(&#34;data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http%3A//www.w3.org/2000/svg' xmlns%3Axlink='http%3A//www.w3.org/1999/xlink' viewBox='0 0 480 360'%3E%3Cfilter id='b' color-interpolation-filters='sRGB'%3E%3CfeGaussianBlur stdDeviation='.5'%3E%3C/feGaussianBlur%3E%3CfeComponentTransfer%3E%3CfeFuncA type='discrete' tableValues='1 1'%3E%3C/feFuncA%3E%3C/feComponentTransfer%3E%3C/filter%3E%3Cimage filter='url(%23b)' x='0' y='0' height='100%25' width='100%25' xlink%3Ahref='data%3Aimage/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAkAAAAHCAIAAABV+fA3AAAACXBIWXMAAAPoAAAD6AG1e1JrAAAAzElEQVQI12MQ5uMpLSnuaGsrLy7Ky0jPyUgvLyvqaGmUFRdhUBbhNjY0i/aNsDEz7Wzp0NM08LDWinI1keRhY+DjZkt1j+h2ivV19S8pTDUydeJlZrDTUdaQlmYQ5OMNVddsNncv0zDKiwkND/PnYWZwMpNRlxdgEOVmrbd36bP1aDSxq4kM9/D3lpaV8YtOc/KLZZCVlCgvKZ05f11JRU1lZdXEuati4pPyMjOdHVwZONnYGBgYrF0CLOycM9LTbb0jeQWEZfjY5fhYAWWCM3hUYJZcAAAAAElFTkSuQmCC'%3E%3C/image%3E%3C/svg%3E&#34;)" width=480></picture><h2>The Obvious</h2><p>If you have ever taken a tutorial, watched a course, or read a book on unit testing, you have probably seen an example that tests a piece of code along the lines of the following:<pre class=language-go><code class=language-go><span class="token keyword">func</span> <span class="token function">Sum</span><span class="token punctuation">(</span>x <span class="token builtin">int</span><span class="token punctuation">,</span> y <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token builtin">int</span> <span class="token punctuation">{</span><br>    <span class="token keyword">return</span> x <span class="token operator">+</span> y<span class="token punctuation">;</span><br><span class="token punctuation">}</span></code></pre><p>No doubt you'll then go on to be shown exactly how you'd write a test that checks a variety of inputs to make sure the <code>Sum</code> function produces the right results for every possible case you can think of.<p>What these tutorials all fail to consider though, is whether the function requires a test in the first place. Having a look at the above example, do you think there's any possibility it's not doing what it claims to be? Could it be expressed in a simpler way? Is it hard to wrap your head around? The answer to all three of these questions is (hopefully) no. This illustrates how code can be intuitively correct at a glance, without the need for extensive proof or testing. Sir Tony Hoare, a hugely influential computer scientist, infamously said the following:<blockquote><p>“There are two ways of constructing a piece of software: One is to make it so simple that there are obviously no errors, and the other is to make it so complicated that there are no obvious errors.”</blockquote><p>This piece of rhetoric fits in perfectly with the questions we asked of the <code>Sum</code> example. In practice we can see that tests are only really needed when something is 'so complicated that there are no obvious errors'. These tests would then prove value by showing that these non-obvious errors don't exist. So for simple, 'obviously' correct code, is there any need to add tests? Instead, before adding tests, you should ask the question: 'Is this code obviously correct, or can I change it make it obviously correct?'. If the answer to this question is yes, then there is no need to test what is obvious.<h2>The Coupled</h2><p>When deciding on what level of tests to write for a system (unit / service / ui / integration / end-to-end, or various other names), the <a href=https://martinfowler.com/bliki/TestPyramid.html>'Testing Pyramid'</a> immediately springs to mind. If you haven't seen the idea before, it suggests that we do the majority of our testing at the individual 'unit' level, This unit level results in tests are fast to run and can quickly, cheaply and efficiently provide a high level of code coverage. We should then provide higher level tests in a much sparser manner, relying on these to effectively prove that everything is wired up and communicating properly, rather than for checking individual branches in logic.<p><picture><source sizes="(max-width: 608px) 100vw, 608px" srcset="/img/remote/Z173t6X-1920w.webp 1920w, /img/remote/Z173t6X-1280w.webp 1280w, /img/remote/Z173t6X-640w.webp 640w, /img/remote/Z173t6X-320w.webp 320w" type=image/webp><source sizes="(max-width: 608px) 100vw, 608px" srcset="/img/remote/Z173t6X-1920w.jpg 1920w, /img/remote/Z173t6X-1280w.jpg 1280w, /img/remote/Z173t6X-640w.jpg 640w, /img/remote/Z173t6X-320w.jpg 320w" type=image/jpeg><img alt="The Testing Pyramid" decoding=async height=300 loading=lazy src=/img/remote/Z173t6X.png style="background-size:cover;contain-intrinsic-size: min(var(--main-width), 560px) min(calc(var(--main-width) * 0.5357142857142857), 300px);background-image:url(&#34;data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http%3A//www.w3.org/2000/svg' xmlns%3Axlink='http%3A//www.w3.org/1999/xlink' viewBox='0 0 560 300'%3E%3Cfilter id='b' color-interpolation-filters='sRGB'%3E%3CfeGaussianBlur stdDeviation='.5'%3E%3C/feGaussianBlur%3E%3CfeComponentTransfer%3E%3CfeFuncA type='discrete' tableValues='1 1'%3E%3C/feFuncA%3E%3C/feComponentTransfer%3E%3C/filter%3E%3Cimage filter='url(%23b)' x='0' y='0' height='100%25' width='100%25' xlink%3Ahref='data%3Aimage/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAGCAIAAACaUPOvAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA10lEQVQI1wHMADP/AOfh29jQxfLv6////7vlyFbAfrPiwv////f7+N3r297r3AD9/v339vT27erp+/w0vJoouJArupPc9fb//fvr9Ov+//4A////+vr5/fLuednkMsLUT8nbQMTXVsvY6/f29Pjx////AP/+//3//e3D075yrMB0rMZ5r8l0rMJlpeOjxvT88////wD//v/7//3nha32QpX3XaL5drH1XqP1RZbtcqrq8+n///8A/Pr73NPJ7srU9I/B8IW48oq88oy99I/A9NDf6Pbp/v7+XECiGRXD0W0AAAAASUVORK5CYII='%3E%3C/image%3E%3C/svg%3E&#34;)" width=560></picture><p>This system is straightforward and initially makes complete sense. It is also the commonly accepted practice. However, it fails to acknowledge that the disposability of code, or the ability to refactor can be a major consideration in what tests to write and how to write them. Any system undergoing continual work will see units, or isolated pieces of code appear, disappear, and take completely different forms over time. This is the natural progress and evolution of working, living software. To emphasise this point, I ask 'have you ever refactored a section of a codebase, to find that existing unit tests are made completely irrelevant or redundant?'. If so, this shows that the initial tests were overly coupled to the layout and structure of the code. Remember that tests are simply more code that agrees with the initial code you just wrote (or if performing TDD, they are simply more code that agrees with the code you are about to write).<p>In areas of code that are rapidly and constantly changing in structure, higher level tests provide a greater level of maintainability and stability, as the higher-level workings of a system are typically more stable. These tests are significantly less likely to be made completely redundant.<p><picture><source sizes="(max-width: 608px) 100vw, 608px" srcset="/img/remote/titanic-tests-1920w.webp 1920w, /img/remote/titanic-tests-1280w.webp 1280w, /img/remote/titanic-tests-640w.webp 640w, /img/remote/titanic-tests-320w.webp 320w" type=image/webp><source sizes="(max-width: 608px) 100vw, 608px" srcset="/img/remote/titanic-tests-1920w.jpg 1920w, /img/remote/titanic-tests-1280w.jpg 1280w, /img/remote/titanic-tests-640w.jpg 640w, /img/remote/titanic-tests-320w.jpg 320w" type=image/jpeg><img alt="Titanic Sinking" decoding=async height=622 loading=lazy src=/img/remote/titanic-tests.png style="background-size:cover;contain-intrinsic-size: min(var(--main-width), 1000px) min(calc(var(--main-width) * 0.622), 622px);background-image:url(&#34;data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http%3A//www.w3.org/2000/svg' xmlns%3Axlink='http%3A//www.w3.org/1999/xlink' viewBox='0 0 1000 622'%3E%3Cfilter id='b' color-interpolation-filters='sRGB'%3E%3CfeGaussianBlur stdDeviation='.5'%3E%3C/feGaussianBlur%3E%3CfeComponentTransfer%3E%3CfeFuncA type='discrete' tableValues='1 1'%3E%3C/feFuncA%3E%3C/feComponentTransfer%3E%3C/filter%3E%3Cimage filter='url(%23b)' x='0' y='0' height='100%25' width='100%25' xlink%3Ahref='data%3Aimage/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAGCAYAAAD68A/GAAAACXBIWXMAAAsSAAALEgHS3X78AAAA2ElEQVQI1x3NwUvCUACA8bf53Hpub2+1pi83NRcT0g4aRJcoKzKpkIxRkHgKrFP//+1rdP5+8ImmkrSSPZTxUbGPSTVBonAcByEE7W6CChVC+i6eloRJC70fENkIzzT/0ezijPn9A25DIlxXIhs+nhfU0ed8UjCdjFg+rXh8qegNyxq6CG1SwtjSz/sUxwPu5ld873bcLCuKckb7KK/XBhHFHXScMj4d8fvzztv2i+nlgu6woGN7aGOJDzJEajOe17e8flasPzZcL1aclGPybFADSxgdEtXXP29AUZOtEe9EAAAAAElFTkSuQmCC'%3E%3C/image%3E%3C/svg%3E&#34;)" width=1000></picture><p>This, however, poses an interesting conundrum: how do we know when code is likely to change in structure or approach in the future? If we could identify these areas ahead of time, then our newfound prescience could simply mean we write them in a better form the first time around. Sadly, however, we are left fumbling in the dark: attempts at organising code are a 'best efforts' approach given a current state of knowledge.<p>We do, however, get an increased understanding of a system the longer it exists, or the longer we work on it. This allows informed decisions about what testing is fully appropriate. Young systems, or systems with a high degree of uncertainty benefit the most from high-level 'black-box' style testing, as these are the most likely to undergo structural change over time. These tests are much less likely to risk redundancy. Contrastingly older, more stable, or better understood systems benefit more from the flexibility and efficient coverage that unit testing can provide.<p>Overall, the age, stability and uncertainty of a system need to underpin what tests we write: the testing pyramid provides an oversimplified view of the world, but a useful tool to consider. However, we need to supplement this with our understanding of code and its evolution over time, asking 'how long will these tests be relevant for?' or 'are these likely to be irrelevant in X months/years time?'.<h2>The Immobile</h2><p>On many of the large scale software projects I have worked on, a rather interesting irony has been present: the most important, business critical pieces of code are often the most insufficiently tested. Their outputs lack clear definition and seemingly any small change could spell disaster. Yet however, they remain this way.<p><picture><source sizes="(max-width: 608px) 100vw, 608px" srcset="/img/remote/immobile-1920w.webp 1920w, /img/remote/immobile-1280w.webp 1280w, /img/remote/immobile-640w.webp 640w, /img/remote/immobile-320w.webp 320w" type=image/webp><source sizes="(max-width: 608px) 100vw, 608px" srcset="/img/remote/immobile-1920w.jpg 1920w, /img/remote/immobile-1280w.jpg 1280w, /img/remote/immobile-640w.jpg 640w, /img/remote/immobile-320w.jpg 320w" type=image/jpeg><img alt="Unmoveable rock" decoding=async height=900 loading=lazy src=/img/remote/immobile.webp style="background-size:cover;contain-intrinsic-size: min(var(--main-width), 1350px) min(calc(var(--main-width) * 0.6666666666666666), 900px);background-image:url(&#34;data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http%3A//www.w3.org/2000/svg' xmlns%3Axlink='http%3A//www.w3.org/1999/xlink' viewBox='0 0 1350 900'%3E%3Cfilter id='b' color-interpolation-filters='sRGB'%3E%3CfeGaussianBlur stdDeviation='.5'%3E%3C/feGaussianBlur%3E%3CfeComponentTransfer%3E%3CfeFuncA type='discrete' tableValues='1 1'%3E%3C/feFuncA%3E%3C/feComponentTransfer%3E%3C/filter%3E%3Cimage filter='url(%23b)' x='0' y='0' height='100%25' width='100%25' xlink%3Ahref='data%3Aimage/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAkAAAAGCAIAAACepSOSAAAACXBIWXMAAAPoAAAD6AG1e1JrAAAAs0lEQVQI1wGoAFf/AFNpcICSm6u4v9be4dDQzt3g4c3R06SqqYiTkABufIGao6rS2N29s6V8XjmDcV7AvrzJzMyco58AdXt9wcXHmZWPb1Avlm1HUTgenpuWzM7Pf4ODAHp9fcLDxJaUkk04JF1CLE9DOsTHyqqtrnh+fgBhX1aAeWyOhWxUQyo+LiBKQi6FfWVkYltGSUYAJiEYNisVRjYSXEojWUcoTkAdNCkSJSAXHh0aXkpNM4kiMnUAAAAASUVORK5CYII='%3E%3C/image%3E%3C/svg%3E&#34;)" width=1350></picture><p>Several years ago I worked on a NHS project. This was, to massively oversimplify, an incredibly complicated and fundamental system responsible for associating prices with hospital treatments and generating reports based on these prices. The report system was well tested, with thousands of tests meticulously checking every single possible output for a massive variety of inputs. Despite all this, the core of the project, the pricing system, was almost entirely lacking in tests. It was only truly tested as a side-effect in testing the reports. The code was incredibly hard to work with and was not amenable to testing, and so it never was. At the time I didn't understand how it could be left that way when it was such a fundamental part of the system.<p>I've later realised the rationale is incredibly simple. The original code was written as a proof of concept. It worked, and as a result became the production code. Nobody wanted to make any changes for fear of causing an unknown regression that could be incredibly difficult and costly to track down and fix. Similarly the process for assigning a price was a fixed piece of logic: it didn't change over time, no new requirements changed how it worked, and nobody really needed to know how it worked internally - just that it did. The cost of not having any tests, even for such an important piece of code, was massively outweighed by the risk in changing the code to make it testable and the effort in testing it.<p>Am I advocating not testing crucial business systems here? No - not at all! However it's important to recognise that we don't live in a perfect world. Systems missing tests for crucial parts exist <em>everywhere</em>, and are far more prevalent than I'd like to admit. However, this isn't the catastrophe younger me thought it was. If a piece of code is complicated, but it works and never changes, then does it matter if it is poorly tested? Adding tests when making changes however, would still be prudent - but we can still ask the question: 'does the benefit of testing this piece of code outweigh the difficulty of adding tests?'. It's a dangerous question to ask, and the answer is almost exclusively 'yes - add the tests'. But just maybe, sometimes, it's a worthy thing to consider.<h2>To Conclude</h2><p>The approach to creating well-designed test suites that provide continual value throughout the lifecycle of a project is a difficult task. Advocates of a 'testing pyramid' approach oversimplify the matter. While the intention is good, it fails to root itself in the practicality of the ever-changing world of software development: the evolution of code over time can easily render tests redundant or unnecessary, and at times those tests can even be a barrier to refactoring. The 'obvious' nature clean code can possess also reduces the need for tests as a proof of correct behaviour. Similarly, a simple cost-benefit analysis should be considered when regarding existing code that is known to be correct and is unchanging, or changing very infrequently. Not all tests are worth writing. Not everything has to be tested, and that is fine.</p><script src=https://ko-fi.com/widgets/widget_2.js type=text/javascript></script><script type=text/javascript>kofiwidget2.init('Support Me on Ko-fi', '#444', 'R6R72KTY9');kofiwidget2.draw();</script><share-widget><button aria-label=Share href=https://dgls.dev/posts/on-testing/ on-click=share><div></div></button></share-widget><script type=application/ld+json>{"@context":"https://schema.org","@type":"Article","headline":"You should only write USEFUL tests","image":["https://dgls.dev/img/remote/nID5p.jpeg","https://dgls.dev/img/remote/Z173t6X.png","https://dgls.dev/img/remote/titanic-tests.png","https://dgls.dev/img/remote/immobile.webp"],"author":"Douglas Parsons","genre":"technology and programming","publisher":{"@type":"Organization","name":"Douglas Parsons","logo":{"@type":"ImageObject","url":"/img/favicon/favicon-192x192.png?hash=1eead310e9"}},"url":"https://dgls.dev/posts/on-testing/","mainEntityOfPage":"https://dgls.dev/posts/on-testing/","datePublished":"2020-09-18","dateModified":"2021-08-10","description":"Through my career in software I&#39;ve come across a broad range of attitudes and opinions towards testing code. The two extremes being that..."}</script></article></main><footer><a href=/about/ >Douglas Parsons</a></footer>